<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.mapper.sys.AccountMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.demo.entity.sys.Account">
        <result column="id" property="id" />
        <result column="account" property="account" />
        <result column="pwd" property="pwd" />
        <result column="create_by" property="createBy" />
        <result column="create_date" property="createDate" />
        <result column="update_by" property="updateBy" />
        <result column="update_date" property="updateDate" />
        <result column="del_flag" property="delFlag" />
        <result column="remark" property="remark" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="BaseColumns">
        a.id,
        a.account,
        a.pwd,
        a.create_by,
        a.create_date,
        a.update_by,
        a.update_date,
        a.del_flag,
        a.remark
    </sql>

    <update id="delAccount" parameterType="String">
        UPDATE comm_account SET del_flag = "0" WHERE id = #{id}
    </update>

    <update id="updatePwd">
        UPDATE comm_account SET
        <trim suffixOverrides=",">
            <if test="entity.pwd != null and entity.pwd != ''">
                pwd = #{entity.pwd}
            </if>
            <if test="entity.updateBy != null and entity.updateBy != ''">
                update_by = #{entity.updateBy}
            </if>
            <if test="entity.updateDate != null">
                update_date = #{entity.updateDate}
            </if>
        </trim>
        WHERE id = #{entity.id}
    </update>

    <select id="login" resultMap="BaseResultMap">
        SELECT
            <trim>
                <include refid="BaseColumns"></include>
            </trim>
        FROM comm_account a
        WHERE account = #{entity.account} AND pwd = #{entity.pwd}
    </select>

    <select id="getAccount" parameterType="String" resultMap="BaseResultMap">
        SELECT
            <trim>
                <include refid="BaseColumns"></include>
            </trim>
        FROM comm_account a
        WHERE account = #{account}
    </select>
    
    <select id="listPage" resultMap="BaseResultMap">
        SELECT
            <trim>
                <include refid="BaseColumns"></include>
            </trim>
        FROM comm_account a
        WHERE del_flag = "0"
    </select>
</mapper>
